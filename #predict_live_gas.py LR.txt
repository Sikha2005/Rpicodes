#predict_live_gas.py


import pandas as pd
import numpy as np
from sklearn.linear_model import LinearRegression
import time

print(" Live Dynamic Gas Prediction Started")

N = 30   # sliding window size

while True:
    df = pd.read_csv("sensor_data.csv")

    if len(df) < N:
        print("Waiting for more data...")
        time.sleep(5)
        continue

    gas = df["gas"].astype(float).values[-N:]

    X = np.arange(len(gas)).reshape(-1, 1)
    y = gas

    # Train model LIVE
    model = LinearRegression()
    model.fit(X, y)

    # Predict next step
    next_step = np.array([[len(gas)]])
    prediction = model.predict(next_step)

    print("Predicted NEXT Gas Value:", round(prediction[0], 2))

    time.sleep(5)
